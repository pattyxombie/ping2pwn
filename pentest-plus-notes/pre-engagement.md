# Pre-Engagement Phase

## Setting the Stage
- Legal groundwork
- Signed agreements
- Stakeholder alignment

Pentesters aim to uncover weaknesses **while upholding legal regulations and industry standards** 

---

# Regulations

**Legally Binding Rules** that must be followed.

###  GDPR – General Data Protection Regulation (EU)
- Strict rules on data processing and transfer **within the EU and when dealing with EU citizens**
- Violations:  Fines of **up to 4% of annual revenue or €20 million** (whichever is higher)

---

###  GLBA – Gramm-Leach-Bliley Act (US)
- Financial privacy for individuals using financial institutions
- Enacted: **1999**
- Focus: **Security and confidentiality of customer data**

---

### HIPAA – Health Insurance Portability and Accountability Act (US)
- Covers healthcare data protection
- Requires:
  - **Physical, administrative, and technical safeguards**
  - **Encrypted patient data**
  - **Regular audits**
- Fines: **$100 to $50,000 per violation**, up to **$1.5M per year**

---

# Standards

**Best practices established by industry leaders** (not always legally required).

### PCI-DSS – Payment Card Industry Data Security Standard
- Benchmark for secure payment card handling
- Requires:
  - Network security
  - Access controls
  - Monitoring and testing
- Non-compliance:  Fines from **$5,000 to $100,000/month**
- Enforced via contracts between merchants and providers

---

### ISO/IEC 27000 Series
- International standard for implementing and maintaining an **Information Security Management System (ISMS)**
- Voluntary, but valuable:
  - Reduces legal risk
  - Builds customer trust
  - Strengthens security posture

---

# Stakeholder Alignment
- Everyone understands objectives AND outcomes of a pentest
- Goals should all be aligned
- Aligns testing with **REGULATIONS and STANDARDS**

## Security Plan
### Details:
- Risk assessments
- Safeguards for info handling
- IR measures
- Ongoing monitoring strategies


# 7 TYPES OF ASSESSMENTS
1. NT - evaluating sec of entire nt for hw + sw vulns, looks at nt topology, fw configs, policies
2. Wireless - protects against eavesdropping
3. Applications - inhouse/third party apps, looks at code dependencies and configs, important part of SDLC prior to deploy
4. Mobile - focus on data leakage, improper session handling, insecure data storage
5. Web Assessments - scrutinize web apps + websites for vulns, SQL injections, XSS, misconfgigs, web apps are all internet facing
6. Cloud - services AND infra, and all the resources (like S3 buckets), look for misconfigs, compliance issues
7. API - app programming interfaces, critical for integration of diff sw systems and services, vulnerable in authentication, authorization, and data validation, geared toward companies who develop their own sw, rely heavily on APIs

# TYPES OF AGREEMENTS
### NDA
- legally binding, establishes confidential relationship bw the parties involved, trust based env., findings are all confidential (more limited in scope, conf clauses in MSA provide longer term protection)

### MSA 
- foundational terms of relationship bw service provider and client that include:
* Project scope
* Payment details
* Confidentiality clauses
* Liability issues
* Eliminates need for separate contracts for each new project/phase				

### SOW - Statement of work
- Specifics of project or service
* Objectives, deliverables (how to report the results)
* Scope
* Timelines
* Payment schedules
* Responsibilities of each party
* Systems to be tested
* Methodologies (tools like nmap)
* Manager expectations


ToS - Terms of service
Govern the use of the services provided by the pentest firm
User rights
Service limitations
Clients obligations
Terms under which tools should be used and that they should not be reverse engineered (unique strategies
Legal and Ethical
Authorization letters - grant permission, clearly defined and agreed upon, specify the nt, hosts and apps, validity period, data handling techniques, reporting guidelines
Mandatory Reporting - dictate how and when to disclose, exceptions and legal obligations, consult with teams legal
Risks to Pentester - downtime and data loss, unintended consequences, take necessary precautions to minimize risk (risk assessment should be done before each test, mutual understanding with client, ex. Rate limiting)
Escalation Path - outlines chain of command, and communication protocols in case of incident, if test interfered with ops, unstable systems, accidental breaches
Rules of Engagement
Build comprehensive framework to GUIDE
Exclusions - ex. PII, business disruptions
Test Cases - predefined scenarios developed by pentest team based on known vulns, potential threat vectors and concerns
Testing Window - agreed upon to limit disruption
Goal reprioritization - allows for changes, dynamic, new info may need flexibility
BIA - post activity, assesses potential consequences for client IF vulns are not remediated and how they can become exploited; aims to clarify link bw  findings and how impact that particular business
Target Selection
Determines scope and goals, most vulnerable assets, prioritisation

CIDR, defines block of IPs
Domains
IPs - specific nodes or servers
URLs (uniform resource locators) - point to specific resources on internet or internal nt often directing traffic to a particular page or service w/in a domain	



Shared Responsibility Model
Roles and resp of various stakeholders

Hosting providers (sec OF the cloud):
Secure infra + hw (data centers, facilities, hard network) that runs all services to customer
Customers (sec IN the cloud):
OS, Apps, data, everything on the hosting infra, sec settings and nt traffic controls
Pentesters:
Find vulns, test effectiveness of controls, simulate attacks on hosts and  customers
CloudServices Recommendations:
(these are the customers first options when it comes to assessments)

AWS - Trusted Advisor and Inspector

Azure - Security Center and Advisor

GCP - Cloud Security Command Center and Cloud Armo

Cloud Pentest - notify provider FIRST, helps prevent alarms and violations to ToS
Internal Pentests on Cloud
Follow guidelines by provider
Ex. AWS identifies permitted services that customers can test:
RDS
EC2 instances
Cloudfront
WAF
ELB
And also the prohibited (DNS Zone walking, hijacking, port/protocol flooding)
If not on the permitted list then request approval, simulated event submission form
FRAMEWORKS
10 of them!!
Guidebooks or sets of rules that help define how to conduct pentests from start to finish
Structured approach to find weaknesses
Engagement management

MITRE ATT&CK / OSSTM
OWASP / Purdue
MASVS / OCTAVE
PTES / DREAD
CREST
STRIDE
FRAMEWORK: MITRE ATT&CK

Threat behaviors and enhances defense strat
Adversarial tactics techniques & common knowledge
Funded by US Comp Emergency Readiness Team and US Dept of Homeland Security
attack.mitre.org
Tactical columns, have sub techniques, provides research and shares info
Tactics:
Initial access, exe, persistence, privesc, defense evasion
FRAMEWORK: OWASP (TOP 10 risks likely exploited)
Open web app sec project, foundational checklist
Mission: sec visible globally to informed decisions
Broken Access Controls
Cryptographic failures (sensitive data expose)
Injection (ex. SQL, untrusted data sent to interpreter
Insecure design
Sec Misconfig
Vuln and outdated components
Id nad authentication failures
SW and Data Integrity Failures
Sec Logging and Monitoring Failures
Server side request forgery
